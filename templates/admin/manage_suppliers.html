<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Manage Suppliers - House-Forge Admin</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: #f5f7fa; }
        .navbar { background: linear-gradient(135deg, #434343 0%, #000000 100%); color: white; padding: 15px 30px; display: flex; justify-content: space-between; align-items: center; box-shadow: 0 2px 10px rgba(0,0,0,0.2); }
        .navbar-brand { font-size: 24px; font-weight: bold; }
        .navbar-menu { display: flex; gap: 20px; align-items: center; }
        .navbar-menu a { color: white; text-decoration: none; padding: 8px 16px; border-radius: 5px; transition: background 0.3s; }
        .navbar-menu a:hover { background: rgba(255,255,255,0.2); }
        .container { max-width: 1400px; margin: 30px auto; padding: 0 20px; }
        .page-header { background: white; padding: 30px; border-radius: 15px; margin-bottom: 30px; box-shadow: 0 2px 10px rgba(0,0,0,0.05); }
        .page-header h1 { font-size: 32px; color: #333; margin-bottom: 10px; }
        .page-header p { color: #666; }
        .alert { padding: 15px 20px; border-radius: 8px; margin-bottom: 20px; }
        .alert-success { background: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
        .alert-error { background: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; }
        .stats-summary { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 30px; }
        .stat-card { background: white; padding: 20px; border-radius: 15px; text-align: center; box-shadow: 0 2px 10px rgba(0,0,0,0.05); }
        .stat-number { font-size: 32px; font-weight: bold; color: #434343; margin-bottom: 5px; }
        .stat-label { color: #666; font-size: 14px; }
        .suppliers-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(400px, 1fr)); gap: 25px; }
        .supplier-card { background: white; border-radius: 15px; padding: 25px; box-shadow: 0 2px 10px rgba(0,0,0,0.05); transition: transform 0.3s, box-shadow 0.3s; }
        .supplier-card:hover { transform: translateY(-5px); box-shadow: 0 5px 20px rgba(0,0,0,0.1); }
        .supplier-header { display: flex; justify-content: space-between; align-items: start; margin-bottom: 20px; padding-bottom: 15px; border-bottom: 2px solid #f0f0f0; }
        .supplier-info h3 { font-size: 20px; color: #333; margin-bottom: 5px; }
        .supplier-company { font-size: 14px; color: #666; }
        .badge { padding: 6px 15px; border-radius: 20px; font-size: 12px; font-weight: 600; }
        .badge-verified { background: #d4edda; color: #155724; }
        .badge-pending { background: #fff3cd; color: #856404; }
        .badge-inactive { background: #f8d7da; color: #721c24; }
        .supplier-details { margin-bottom: 20px; }
        .detail-row { display: flex; justify-content: space-between; padding: 10px 0; border-bottom: 1px solid #f5f5f5; }
        .detail-row:last-child { border-bottom: none; }
        .detail-label { color: #666; font-weight: 600; }
        .detail-value { color: #333; }
        .supplier-actions { display: flex; gap: 10px; }
        .btn { flex: 1; padding: 10px; border-radius: 8px; text-decoration: none; font-weight: 600; text-align: center; transition: all 0.3s; border: none; cursor: pointer; font-size: 14px; }
        .btn-success { background: #28a745; color: white; }
        .btn-success:hover { background: #218838; transform: translateY(-2px); }
        .btn-danger { background: #dc3545; color: white; }
        .btn-danger:hover { background: #c82333; transform: translateY(-2px); }
        .btn-primary { background: #007bff; color: white; }
        .btn-primary:hover { background: #0056b3; transform: translateY(-2px); }
        .empty-state { text-align: center; padding: 80px 20px; background: white; border-radius: 15px; }
        .empty-icon { font-size: 80px; margin-bottom: 20px; }
    </style>
</head>
<body>
    <nav class="navbar">
        <div class="navbar-brand">‚öôÔ∏è House-Forge Admin</div>
        <div class="navbar-menu">
            <a href="{{ url_for('admin.dashboard') }}">Dashboard</a>
            <a href="{{ url_for('admin.manage_users') }}">Users</a>
            <a href="{{ url_for('admin.manage_contractors') }}">Contractors</a>
            <a href="{{ url_for('admin.manage_suppliers') }}">Suppliers</a>
            <a href="{{ url_for('admin.all_projects') }}">Projects</a>
            <a href="{{ url_for('auth.logout') }}">Logout</a>
        </div>
    </nav>
    
    <div class="container">
        <div class="page-header">
            <h1>üì¶ Manage Suppliers</h1>
            <p>Verify and manage supplier accounts</p>
        </div>
        
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                {% for category, message in messages %}
                    <div class="alert alert-{{ category }}">{{ message }}</div>
                {% endfor %}
            {% endif %}
        {% endwith %}
        
        <div class="stats-summary">
            <div class="stat-card">
                <div class="stat-number">{{ suppliers|length }}</div>
                <div class="stat-label">Total Suppliers</div>
            </div>
            <div class="stat-card">
                <div class="stat-number">{{ suppliers|selectattr('verified', 'equalto', true)|list|length }}</div>
                <div class="stat-label">Verified</div>
            </div>
            <div class="stat-card">
                <div class="stat-number">{{ suppliers|rejectattr('verified', 'equalto', true)|list|length }}</div>
                <div class="stat-label">Pending Verification</div>
            </div>
            <div class="stat-card">
                <div class="stat-number">{{ suppliers|rejectattr('active', 'equalto', true)|list|length }}</div>
                <div class="stat-label">Inactive</div>
            </div>
        </div>
        
        {% if suppliers %}
            <div class="suppliers-grid">
                {% for supplier in suppliers %}
                <div class="supplier-card">
                    <div class="supplier-header">
                        <div class="supplier-info">
                            <h3>{{ supplier.company_name or supplier.name }}</h3>
                            <div class="supplier-company">{{ supplier.name if supplier.company_name else 'Supplier' }}</div>
                        </div>
                        <div>
                            {% if supplier.verified %}
                                <span class="badge badge-verified">‚úì Verified</span>
                            {% else %}
                                <span class="badge badge-pending">‚è≥ Pending</span>
                            {% endif %}
                            {% if not supplier.get('active', True) %}
                                <span class="badge badge-inactive">Inactive</span>
                            {% endif %}
                        </div>
                    </div>
                    
                    <div class="supplier-details">
                        <div class="detail-row">
                            <span class="detail-label">Email:</span>
                            <span class="detail-value">{{ supplier.email }}</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Phone:</span>
                            <span class="detail-value">{{ supplier.phone or 'N/A' }}</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Business Type:</span>
                            <span class="detail-value">{{ supplier.business_type or 'N/A' }}</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Rating:</span>
                            <span class="detail-value">{{ "%.1f"|format(supplier.rating or 0) }} ‚≠ê</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">GST Number:</span>
                            <span class="detail-value">{{ supplier.gst_number or 'N/A' }}</span>
                        </div>
                    </div>
                    
                    <div class="supplier-actions">
                        {% if not supplier.verified %}
                        <form method="POST" action="{{ url_for('admin.verify_supplier', supplier_id=supplier.id) }}" style="flex: 1;">
                            <button type="submit" class="btn btn-success">‚úì Verify</button>
                        </form>
                        {% endif %}
                        
                        {% if supplier.get('active', True) %}
                        <form method="POST" action="{{ url_for('admin.deactivate_user', user_type='supplier', user_id=supplier.id) }}" style="flex: 1;">
                            <button type="submit" class="btn btn-danger" onclick="return confirm('Deactivate this supplier?')">Block</button>
                        </form>
                        {% else %}
                        <form method="POST" action="{{ url_for('admin.activate_user', user_type='supplier', user_id=supplier.id) }}" style="flex: 1;">
                            <button type="submit" class="btn btn-primary">Activate</button>
                        </form>
                        {% endif %}
                    </div>
                </div>
                {% endfor %}
            </div>
        {% else %}
            <div class="empty-state">
                <div class="empty-icon">üîç</div>
                <h2>No Suppliers Found</h2>
                <p>No supplier accounts in the system yet.</p>
            </div>
        {% endif %}
    </div>
</body>
</html>